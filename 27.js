/*! For license information please see 27.js.LICENSE.txt */
"use strict";(self.webpackChunkoffice_addin_taskpane_react_js=self.webpackChunkoffice_addin_taskpane_react_js||[]).push([[27,688],{56786:function(e,t,n){n.d(t,{FY:function(){return a},Mb:function(){return l},Me:function(){return i},j_:function(){return o},r6:function(){return r}});var r="mutation UpdateBomitemsMutation(\n    $bom_items: [bom_items_insert_input!]!,\n    $bom_id: Int) {\n    insert_bom_versions(\n      objects: {\n        bom_id: $bom_id,\n        bom_items: {data: $bom_items}\n      }\n    ) {\n      affected_rows\n    }\n  }",o="mutation exportMaterialMasterDataAsOne($materials: [core_material_master_insert_input!]!) {\n  insert_core_material_master(objects: $materials) {\n    returning{\n      id\n      custom_material_id\n    }\n    affected_rows\n  }\n}",a="mutation CreateProductBomQuery(\n  $name: String!,\n  $items: [bomItemsArray],\n  $product_code_id: Int!,\n  ) {\n  insert_bom(\n    product_code_id: $product_code_id,\n    bom_data: {\n      items: $items,\n      name: $name,\n    }) {\n    message\n  }\n}\n",i="mutation CreateProjectBomQuery(\n  $name: String!,\n  $items: [bomItemsArray],\n  ) {\n  insert_bom(\n    bom_data: {\n      items: $items,\n      name: $name,\n    }) {\n    message\n  }\n}",l="mutation mappingConfigDataMutation($tenant_id: Int!, $bom:jsonb!, $material:jsonb!) {\n  update_tenant_defaults(\n    where: {tenant_id: {_eq: $tenant_id}}\n    _set: {bom: $bom, material: $material}\n  ) {\n    affected_rows\n  }\n}\n"},23383:function(e,t,n){n.d(t,{Z:function(){return w}});var r=n(67294),o=n(85656),a=n(19018),i=n(58119),l=n(19617),u=n(93379),s=n.n(u),c=n(7795),d=n.n(c),p=n(90569),f=n.n(p),m=n(3565),v=n.n(m),h=n(19216),g=n.n(h),y=n(44589),_=n.n(y),b=n(20890),x={};x.styleTagTransform=_(),x.setAttributes=v(),x.insert=f().bind(null,"head"),x.domAPI=d(),x.insertStyleElement=g(),s()(b.Z,x),b.Z&&b.Z.locals&&b.Z.locals;var w=function(e){var t=e.options,n=e.handleChange,u=e.value,s=e.label,c=e.noOptionMessage,d=void 0===c?"No option available":c,p=e.isLoading,f=void 0===p||p,m=(0,o.v9)((function(e){return e.action})),v=m.sideBarOpen,h=m.uploadLoader,g=null==t?void 0:t.filter((function(e,t,n){return t===(null==n?void 0:n.findIndex((function(t){return(null==t?void 0:t.label)===(null==e?void 0:e.label)})))}));return r.createElement("div",{className:"react-select-dd"},s&&r.createElement("p",null,s),r.createElement(l.ZP,{options:g,components:{NoOptionsMessage:function(e){return r.createElement(i.c.NoOptionsMessage,e,r.createElement("span",{className:"custom-css-class"},d))}},styles:a.X2,onChange:n,value:u,className:"".concat(v?"selectType":" "),isDisabled:!!h,isLoading:f}))}},17027:function(e,t,n){n.r(t),n.d(t,{default:function(){return te}});var r=n(67294),o=n(85656),a=n(46027),i=n(93379),l=n.n(i),u=n(7795),s=n.n(u),c=n(90569),d=n.n(c),p=n(3565),f=n.n(p),m=n(19216),v=n.n(m),h=n(44589),g=n.n(h),y=n(88638),_={};_.styleTagTransform=g(),_.setAttributes=f(),_.insert=d().bind(null,"head"),_.domAPI=s(),_.insertStyleElement=v(),l()(y.Z,_),y.Z&&y.Z.locals&&y.Z.locals;var b=n(21559),x=n(81486),w=n(3193),A=n(1833),k=n(12961),E=n(56786),I=n(68518),S=n(23383),C=n(60392),B=n(19018),j=n(82702).Promise;function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function $(){$=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,o){var a=t&&t.prototype instanceof p?t:p,i=Object.create(a.prototype),l=new E(o||[]);return r(i,"_invoke",{value:x(e,n,l)}),i}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var d={};function p(){}function f(){}function m(){}var v={};u(v,a,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(I([])));g&&g!==t&&n.call(g,a)&&(v=g);var y=m.prototype=p.prototype=Object.create(v);function _(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function o(r,a,i,l){var u=c(e[r],e,a);if("throw"!==u.type){var s=u.arg,d=s.value;return d&&"object"==N(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,l)}),(function(e){o("throw",e,i,l)})):t.resolve(d).then((function(e){s.value=e,i(s)}),(function(e){return o("throw",e,i,l)}))}l(u.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function x(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return{value:void 0,done:!0}}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var l=w(i,n);if(l){if(l===d)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=c(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function I(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=m,r(y,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:f,configurable:!0}),f.displayName=u(m,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,l,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},_(b.prototype),u(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,r,o,a){void 0===a&&(a=j);var i=new b(s(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},_(y),u(y,l,"Generator"),u(y,a,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=I,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function O(e,t,n,r,o,a,i){try{var l=e[a](i),u=l.value}catch(e){return void n(e)}l.done?t(u):j.resolve(u).then(r,o)}function L(e){return function(){var t=this,n=arguments;return new j((function(r,o){var a=e.apply(t,n);function i(e){O(a,r,o,i,l,"next",e)}function l(e){O(a,r,o,i,l,"throw",e)}i(void 0)}))}}function T(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==N(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==N(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===N(o)?o:String(o)),r)}var o}function F(e,t,n){return t&&R(e.prototype,t),n&&R(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var M=F((function e(t){U(this,e),this.name=t,this.materialIds=[],this.uploadedParentId=null,this.isUploaded=!1,this.uploadedId=null,this.isEndOfTag=!1,this.children={}})),G=function(){function e(){U(this,e),this.root=new M(null),this.materialTagUploadData=[]}var t,n,r,o;return F(e,[{key:"insert",value:function(e,t){var n,r=this.root,o=T(t.split("_"));try{for(o.s();!(n=o.n()).done;){var a=n.value;void 0===r.children[a]&&(r.children[a]=new M(a)),r.children[a].materialIds.push(e),r=r.children[a]}}catch(e){o.e(e)}finally{o.f()}r.isEndOfTag=!0}},{key:"uploadTagToDtx",value:(o=L($().mark((function e(t){var n,r,o,a=arguments;return $().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:null,r=localStorage.getItem("tenantToken"),o={query:"\nmutation insert_tag($tagName: String, $parentId: Int) {\n  insert_tag_one(object: {name: $tagName, parent_id: $parentId}, on_conflict: {constraint: tag_name_parent_id_key, update_columns: []})  {\n    id\n  }\n}\n",variables:{tagName:t,parentId:n}},e.abrupt("return",new j((function(e,t){setTimeout(L($().mark((function n(){var a;return $().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,k.g)(w.Bk,r,o);case 2:(a=n.sent).errors&&(console.log({error:a.errors}),t(a.errors)),e(a.data.insert_tag_one.id);case 5:case"end":return n.stop()}}),n)}))),3e3)})));case 4:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"checkTagExists",value:(r=L($().mark((function e(t){var n,r;return $().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("tenantToken"),r={query:"query tags($tagName: String!) {\n  tag(where: {name: {_eq: $tagName}, parent_id: {_is_null: true}}) {\n    id\n  }\n}",variables:{tagName:t}},e.abrupt("return",new j((function(e,t){setTimeout(L($().mark((function o(){var a;return $().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,k.g)(w.Bk,n,r);case 2:(a=o.sent).errors&&(console.log({error:a.errors}),t(a.errors)),e(a.data.tag);case 5:case"end":return o.stop()}}),o)}))),3e3)})));case 3:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"uploadAllTags",value:(n=L($().mark((function e(){var t,n,r,o,a,i,l,u,s,c,d=arguments;return $().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=d.length>0&&void 0!==d[0]?d[0]:this.root,n=0,r=Object.values(t.children);case 2:if(!(n<r.length)){e.next=34;break}if((o=r[n]).uploadedParentId=t.uploadedId,o.isUploaded){e.next=29;break}if(t.name){e.next=22;break}return e.next=9,this.checkTagExists(o.name);case 9:if(!((a=e.sent).length>0)){e.next=15;break}o.uploadedId=a[0].id,o.isUploaded=!0,e.next=20;break;case 15:return e.next=17,this.uploadTagToDtx(o.name,o.uploadedParentId);case 17:i=e.sent,o.uploadedId=i,o.isUploaded=!0;case 20:e.next=27;break;case 22:return e.next=24,this.uploadTagToDtx(o.name,o.uploadedParentId);case 24:l=e.sent,o.uploadedId=l,o.isUploaded=!0;case 27:u=T(o.materialIds);try{for(u.s();!(s=u.n()).done;)c=s.value,this.materialTagUploadData.push({material_id:c,tag_id:o.uploadedId})}catch(e){u.e(e)}finally{u.f()}case 29:return e.next=31,this.uploadAllTags(o);case 31:n++,e.next=2;break;case 34:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"uploadMaterialTags",value:(t=L($().mark((function e(){var t,n,r;return $().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("tenantToken"),n={query:"\nmutation insert_material_tag($tag_materials:[tag_material_insert_input!]!) {\n  insert_tag_material(objects:$tag_materials, on_conflict: {constraint: tag_material_pkey, update_columns: []}) {\n    affected_rows\n  }\n}\n",variables:{tag_materials:this.materialTagUploadData}},e.next=4,(0,k.g)(w.Bk,t,n);case 4:if(!(r=e.sent).errors){e.next=8;break}throw console.log({error:r.errors}),new Error(r.errors);case 8:return e.abrupt("return",r.data);case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),q=new G,D=n(82702).Promise;function Z(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=K(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw a}}}}function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function W(){W=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",i=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,n){return e[t]=n}}function s(e,t,n,o){var a=t&&t.prototype instanceof p?t:p,i=Object.create(a.prototype),l=new E(o||[]);return r(i,"_invoke",{value:x(e,n,l)}),i}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var d={};function p(){}function f(){}function m(){}var v={};u(v,a,(function(){return this}));var h=Object.getPrototypeOf,g=h&&h(h(I([])));g&&g!==t&&n.call(g,a)&&(v=g);var y=m.prototype=p.prototype=Object.create(v);function _(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function o(r,a,i,l){var u=c(e[r],e,a);if("throw"!==u.type){var s=u.arg,d=s.value;return d&&"object"==z(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){o("next",e,i,l)}),(function(e){o("throw",e,i,l)})):t.resolve(d).then((function(e){s.value=e,i(s)}),(function(e){return o("throw",e,i,l)}))}l(u.arg)}var a;r(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}})}function x(e,t,n){var r="suspendedStart";return function(o,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw a;return{value:void 0,done:!0}}for(n.method=o,n.arg=a;;){var i=n.delegate;if(i){var l=w(i,n);if(l){if(l===d)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function w(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var o=c(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,d;var a=o.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function I(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:S}}function S(){return{value:void 0,done:!0}}return f.prototype=m,r(y,"constructor",{value:m,configurable:!0}),r(m,"constructor",{value:f,configurable:!0}),f.displayName=u(m,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,u(e,l,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},_(b.prototype),u(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,n,r,o,a){void 0===a&&(a=D);var i=new b(s(t,n,r,o),a);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},_(y),u(y,l,"Generator"),u(y,a,(function(){return this})),u(y,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=I,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function Y(e,t,n,r,o,a,i){try{var l=e[a](i),u=l.value}catch(e){return void n(e)}l.done?t(u):D.resolve(u).then(r,o)}function H(e){return function(){var t=this,n=arguments;return new D((function(r,o){var a=e.apply(t,n);function i(e){Y(a,r,o,i,l,"next",e)}function l(e){Y(a,r,o,i,l,"throw",e)}i(void 0)}))}}function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){J(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function J(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==z(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===z(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,l=[],u=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(l.push(r.value),l.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return l}}(e,t)||K(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var te=function(){var e=(0,o.v9)((function(e){return null==e?void 0:e.action})).lastUsedColumn,t=(0,o.v9)((function(e){return null==e?void 0:e.taskpane})),n=t.MMmappingData,i=t.mmExportFailedRows,l=t.mmExportSuccessRows,u=(0,o.I0)(),s=Q((0,r.useState)(!1),2),c=s[0],d=s[1],p=Q((0,r.useState)([]),2),f=p[0],m=p[1],v=Q((0,r.useState)(null),2),h=v[0],g=v[1],y=Q((0,r.useState)([]),2),_=y[0],j=y[1],N=Q((0,r.useState)(!1),2),$=N[0],O=N[1],L=Q((0,r.useState)([]),2),T=(L[0],L[1]),P=Q((0,r.useState)([]),2),R=(P[0],P[1]),F=Q((0,r.useState)({}),2),U=(F[0],F[1]),M=[],G=[];(0,r.useEffect)((function(){Excel.run((function(e){var t=e.workbook.worksheets,n=[];return e.load(t,"items/name"),e.sync().then((function(){for(var e=0;e<(null==t||null===(r=t.items)||void 0===r?void 0:r.length);e++){var r,o,a;n.push({value:null==t||null===(o=t.items[e])||void 0===o?void 0:o.name,label:null==t||null===(a=t.items[e])||void 0===a?void 0:a.name})}m(n)}))})).catch((function(e){console.log(e)}))}),[]);var D={control:function(e,t){return X(X({},e),{},{borderColor:t.isFocused?"#383332":"##383332",boxShadow:(t.isFocused,null),"&:hover":{borderColor:(t.isFocused,null)},minHeight:28,height:28,width:250,padding:"0px 0px"})},option:function(e,t){return X(X({},e),{},{backgroundColor:t.isSelected?"#FFC467":"##F8F4F0",color:(t.isSelected,"#383332"),"&:hover":{backgroundColor:"#F8F4F0"},minHeight:18,width:250,paddingBottom:4})},dropdownIndicator:function(e){return X(X({},e),{},{padding:4})},input:function(e,t){return X(X({},e),{},{padding:"0px 0px 0px"})}};(0,r.useEffect)((function(){document.getElementById("material-export-warning").style.display="none",document.getElementById("material-export-success").style.display="none"}),[]);var Y=function(){var e=H(W().mark((function e(t){var r,o,a,i;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g(t),(0,A.Ix)(null==t?void 0:t.value),r=[],o=Object.entries(n),a=W().mark((function e(n){return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=H(W().mark((function e(a){var i;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.workbook.worksheets.getItem(String(null==t?void 0:t.value)).getRange(String(o[n][1].address+"1")).load("values"),e.next=3,a.sync();case 3:null==r||r.push({dtxField:o[n][1].name,excelField:null==i?void 0:i.values[0][0],address:o[n][1].address});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})),i=0;case 6:if(!(i<o.length)){e.next=11;break}return e.delegateYield(a(i),"t0",8);case 8:i++,e.next=6;break;case 11:j(r);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=H(W().mark((function e(){return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=H(W().mark((function e(t){var r,o,i,l,s;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.workbook.worksheets.getItem(String(null==h?void 0:h.value)),o=r.getUsedRange().load("rowCount"),e.next=4,t.sync();case 4:if(n.hasOwnProperty("unit_of_material")){e.next=9;break}d(!0),(0,x.setTimeout)((function(){d(!1)}),3e3),e.next=33;break;case 9:l=localStorage.getItem("tenantToken"),u((0,b.Et)(!0)),ee(),console.log("started",parseInt(o.rowCount)),s=2;case 14:if(!(s<=parseInt(o.rowCount))){e.next=20;break}return e.next=17,K(s,l);case 17:s++,e.next=14;break;case 20:if(null==n||null===(i=n.tags)||void 0===i||!i.address){e.next=27;break}return u((0,b.Et)(!0)),e.next=24,q.uploadAllTags();case 24:return e.next=26,q.uploadMaterialTags();case 26:u((0,b.Et)(!1));case 27:u((0,b.Eh)(null)),u((0,a.Tx)(G)),u((0,a.H8)(M)),u((0,b.Et)(!1)),O(!0),console.log(M,G);case 33:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=11;break;case 5:e.prev=5,e.t0=e.catch(0),console.log("Error:",e.t0),u((0,a.Tx)(G)),u((0,a.H8)(M)),u((0,b.Et)(!1));case 11:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=H(W().mark((function e(t,r){var o;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u((0,b.Et)(!0)),o={},e.next=5,Excel.run(function(){var e=H(W().mark((function e(a){var i,l,s,c,d,p,f,m,v,g,y,_,x,A,k,E,I,S,C,B,j,N,$,O,L,T,P,R,F,D,Z,z,Y,H,V,Q,K,ee,re,oe,ae,ie,le,ue,se,ce,de,pe,fe,me,ve,he,ge,ye,_e,be,xe,we,Ae,ke,Ee,Ie;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ae=a.workbook.worksheets.getItem(String(null==h?void 0:h.value)),ie=null!=n&&null!==(i=n.custom_material_id)&&void 0!==i&&i.address?ae.getRange(String((null==n||null===(l=n.custom_material_id)||void 0===l?void 0:l.address)+t)).load("values"):null,le=null!=n&&null!==(s=n.erp_material_id)&&void 0!==s&&s.address?ae.getRange(String((null==n||null===(c=n.erp_material_id)||void 0===c?void 0:c.address)+t)).load("values"):null,ue=null!=n&&null!==(d=n.gross_weight)&&void 0!==d&&d.address?ae.getRange(String((null==n||null===(p=n.gross_weight)||void 0===p?void 0:p.address)+t)).load("values"):null,se=null!=n&&null!==(f=n.inventory)&&void 0!==f&&f.address?ae.getRange(String((null==n||null===(m=n.inventory)||void 0===m?void 0:m.address)+t)).load("values"):null,ce=null!=n&&null!==(v=n.lead_time)&&void 0!==v&&v.address?ae.getRange(String((null==n||null===(g=n.lead_time)||void 0===g?void 0:g.address)+t)).load("values"):null,de=null!=n&&null!==(y=n.material_description)&&void 0!==y&&y.address?ae.getRange(String((null==n||null===(_=n.material_description)||void 0===_?void 0:_.address)+t)).load("values"):null,pe=null!=n&&null!==(x=n.material_group)&&void 0!==x&&x.address?ae.getRange(String((null==n||null===(A=n.material_group)||void 0===A?void 0:A.address)+t)).load("values"):null,fe=null!=n&&null!==(k=n.material_name)&&void 0!==k&&k.address?ae.getRange(String((null==n||null===(E=n.material_name)||void 0===E?void 0:E.address)+t)).load("values"):null,me=null!=n&&null!==(I=n.others)&&void 0!==I&&I.address?ae.getRange(String((null==n||null===(S=n.others)||void 0===S?void 0:S.address)+t)).load("values"):null,ve=null!=n&&null!==(C=n.parent_id)&&void 0!==C&&C.address?ae.getRange(String((null==n||null===(B=n.parent_id)||void 0===B?void 0:B.address)+t)).load("values"):null,he=null!=n&&null!==(j=n.plm_material_id)&&void 0!==j&&j.address?ae.getRange(String((null==n||null===(N=n.plm_material_id)||void 0===N?void 0:N.address)+t)).load("values"):null,ge=null!=n&&null!==($=n.plm_record_id)&&void 0!==$&&$.address?ae.getRange(String((null==n||null===(O=n.plm_record_id)||void 0===O?void 0:O.address)+t)).load("values"):null,ye=null!=n&&null!==(L=n.product_code)&&void 0!==L&&L.address?ae.getRange(String((null==n||null===(T=n.product_code)||void 0===T?void 0:T.address)+t)).load("values"):null,_e=null!=n&&null!==(P=n.quantity)&&void 0!==P&&P.address?ae.getRange(String((null==n||null===(R=n.quantity)||void 0===R?void 0:R.address)+t)).load("values"):null,be=null!=n&&null!==(F=n.unit_cost)&&void 0!==F&&F.address?ae.getRange(String((null==n||null===(D=n.unit_cost)||void 0===D?void 0:D.address)+t)).load("values"):null,xe=null!=n&&null!==(Z=n.storage_loc)&&void 0!==Z&&Z.address?ae.getRange(String((null==n||null===(z=n.storage_loc)||void 0===z?void 0:z.address)+t)).load("values"):null,we=null!=n&&null!==(Y=n.unit_of_material)&&void 0!==Y&&Y.address?ae.getRange(String((null==n||null===(H=n.unit_of_material)||void 0===H?void 0:H.address)+t)).load("values"):null,Ae=null!=n&&null!==(V=n.unit_sale_price)&&void 0!==V&&V.address?ae.getRange(String((null==n||null===(Q=n.unit_sale_price)||void 0===Q?void 0:Q.address)+t)).load("values"):null,ke=null!=n&&null!==(K=n.weight_unit)&&void 0!==K&&K.address?ae.getRange(String((null==n||null===(ee=n.weight_unit)||void 0===ee?void 0:ee.address)+t)).load("values"):null,Ee=null!=n&&null!==(re=n.tags)&&void 0!==re&&re.address?ae.getRange(String((null==n||null===(oe=n.tags)||void 0===oe?void 0:oe.address)+t)).load("values"):null,e.next=23,a.sync();case 23:return o={custom_material_id:String(null==ie?void 0:ie.values[0][0]),erp_material_id:null==le?void 0:le.values[0][0],gross_weight:null==ue?void 0:ue.values[0][0],inventory:null==se?void 0:se.values[0][0],lead_time:null==ce?void 0:ce.values[0][0],material_description:null==de?void 0:de.values[0][0],material_group:null==pe?void 0:pe.values[0][0],material_name:null==fe?void 0:fe.values[0][0],others:null==me?void 0:me.values[0][0],parent_id:null==ve?void 0:ve.values[0][0],plm_material_id:String(null==he?void 0:he.values[0][0]),plm_record_id:null==ge?void 0:ge.values[0][0],product_code:null==ye?void 0:ye.values[0][0],quantity:null==_e?void 0:_e.values[0][0],unit_cost:null==be?void 0:be.values[0][0],storage_loc:null==xe?void 0:xe.values[0][0],unit_of_material:null==we?void 0:we.values[0][0],unit_sale_price:null==Ae?void 0:Ae.values[0][0],weight_unit:null==ke?void 0:ke.values[0][0]},Ie={operationName:"CreateMaterialMaster",variables:o,query:"mutation CreateMaterialMaster($custom_material_id: String, $erp_material_id: String, $gross_weight: Int, $inventory: Int, $lead_time: Int, $material_description: String, $material_group: Int, $material_name: String, $others: jsonb, $parent_id: Int, $plm_material_id: String, $plm_record_id: String, $product_code: Int, $quantity: float8, $storage_loc: Int, $unit_cost: Int, $unit_of_material: String, $unit_sale_price: Int, $weight_unit: String) {\n  insert_core_material_master_one(\n    object: {custom_material_id: $custom_material_id, erp_material_id: $erp_material_id, gross_weight: $gross_weight, inventory: $inventory, lead_time: $lead_time, material_description: $material_description, material_group: $material_group, material_name: $material_name, others: $others, parent_id: $parent_id, plm_material_id: $plm_material_id, plm_record_id: $plm_record_id, product_code: $product_code, quantity: $quantity, unit_cost: $unit_cost, storage_loc: $storage_loc, unit_of_material: $unit_of_material, unit_sale_price: $unit_sale_price, weight_unit: $weight_unit}\n  ) {\n    id\n    __typename\n  }\n}\n"},e.next=27,fetch(w.Bk,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+r},body:JSON.stringify(Ie)}).then((function(e){return e.json()})).then((function(e){var r;console.log(e.data.insert_core_material_master_one),e.data?(null!=n&&null!==(r=n.tags)&&void 0!==r&&r.address&&(console.log(Ee.values[0][0]),q.insert(e.data.insert_core_material_master_one.id,String(null==Ee?void 0:Ee.values[0][0]))),U((function(n){return X(X({},n),{},J({},t,e.data.insert_core_material_master_one.id))})),u((0,b.Et)(!1)),te(t),G.push(t)):(console.log(t,"error happened"),ne(t),M.push(t))})).catch((function(e){console.log("Error",e),ne(t),M.push(t),u((0,b.Et)(!1))}));case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),u((0,b.Et)(!1)),console.log("Error:",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),ee=function(){var e=H(W().mark((function e(){return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=H(W().mark((function e(t){var n,r,o,a;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.workbook.worksheets.getItem(String(null==h?void 0:h.value)),a=o.getUsedRange().load("address"),e.next=4,t.sync();case 4:u((0,b.Eh)(null==a||null===(n=a.address)||void 0===n||null===(r=n.split(":")[1])||void 0===r?void 0:r.split("")[0]));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){var t=H(W().mark((function t(n){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("inside success"),!e){t.next=6;break}return t.next=4,Excel.run(function(){var t=H(W().mark((function t(r){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.workbook.worksheets.getItem(String(null==h?void 0:h.value)).getRange(String("A".concat(n,":").concat(e+n))).format.fill.color="#3eea4a";case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 4:t.next=8;break;case 6:return t.next=8,Excel.run(function(){var e=H(W().mark((function e(t){var r,o;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.workbook.worksheets.getItem(String(null==h?void 0:h.value)),o=r.getUsedRange().load("address"),e.abrupt("return",t.sync().then((function(){var e,r;t.workbook.worksheets.getItem(String(null==h?void 0:h.value)).getRange(String("A".concat(n,":").concat((null==o||null===(e=o.address)||void 0===e||null===(r=e.split(":")[1])||void 0===r?void 0:r.split("")[0])+n))).format.fill.color="#3eea4a"})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ne=function(){var t=H(W().mark((function t(n){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return t.next=3,Excel.run(function(){var t=H(W().mark((function t(r){return W().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.workbook.worksheets.getItem(String(null==h?void 0:h.value)).getRange(String("A".concat(n,":").concat(e+n))).format.fill.color="#d03758";case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 3:t.next=7;break;case 5:return t.next=7,Excel.run(function(){var e=H(W().mark((function e(t){var r,o;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.workbook.worksheets.getItem(String(null==h?void 0:h.value)),o=r.getUsedRange().load("address"),e.abrupt("return",t.sync().then((function(){var e,r;t.workbook.worksheets.getItem(String(null==h?void 0:h.value)).getRange(String("A".concat(n,":").concat((null==o||null===(e=o.address)||void 0===e||null===(r=e.split(":")[1])||void 0===r?void 0:r.split("")[0])+n))).format.fill.color="#d03758"})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),re=function(){var e=H(W().mark((function e(){var t,n;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=localStorage.getItem("tenantToken"),u((0,b.Et)(!0)),M=[],G=[],n=0;case 5:if(!(n<i.length)){e.next=11;break}return e.next=8,K(parseInt(i[n]),t);case 8:n++,e.next=5;break;case 11:u((0,b.Et)(!1)),u((0,a.Tx)(G)),u((0,a.H8)(M)),console.log(M,G);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=H(W().mark((function e(){return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.O)();case 2:Excel.run(function(){var e=H(W().mark((function e(t){var r,o,a,i,l,u,s,c,d,p,f,m,v,h,g,y,_,b,x,w,A,k,E,I,S,C,B,j,N,$,O,L,P,F,U,M,G,q,D,Z,Y,H,V,X,J,Q,K,ee,te;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ee=function(e,t,n,r,o){var a,i,u,s;if(!(null===n[(null===(a=e[t])||void 0===a?void 0:a.columnNumber)-1]||void 0===n[(null===(i=e[t])||void 0===i?void 0:i.columnNumber)-1]||""===n[(null===(u=e[t])||void 0===u?void 0:u.columnNumber)-1]||r&&z(n[(null===(s=e[t])||void 0===s?void 0:s.columnNumber)-1])!==r))return!0;l.push(e[t].address+(o+1))},r=t.workbook.worksheets.getActiveWorksheet(),(o=r.getUsedRange()).load("values"),e.next=6,t.sync();case 6:for(a=o.values,i=[],l=[],u={},s=1;s<a.length;s++)(Q={}).custom_material_id=null!=n&&null!==(c=n.custom_material_id)&&void 0!==c&&c.address&&ee(n,"custom_material_id",a[s],!1,s)?String(a[s][(null==n||null===(d=n.custom_material_id)||void 0===d?void 0:d.columnNumber)-1]):null,Q.erp_material_id=null!=n&&null!==(p=n.erp_material_id)&&void 0!==p&&p.address&&ee(n,"erp_material_id",a[s],!1,s)?String(a[s][(null==n||null===(f=n.erp_material_id)||void 0===f?void 0:f.columnNumber)-1]):null,Q.gross_weight=null!=n&&null!==(m=n.gross_weight)&&void 0!==m&&m.address&&ee(n,"gross_weight",a[s],"number",s)?a[s][(null==n||null===(v=n.gross_weight)||void 0===v?void 0:v.columnNumber)-1]:null,Q.inventory=null!=n&&null!==(h=n.inventory)&&void 0!==h&&h.address&&ee(n,"inventory",a[s],"number",s)?a[s][(null==n||null===(g=n.inventory)||void 0===g?void 0:g.columnNumber)-1]:null,Q.lead_time=null!=n&&null!==(y=n.lead_time)&&void 0!==y&&y.address&&ee(n,"lead_time",a[s],"number",s)?a[s][(null==n||null===(_=n.lead_time)||void 0===_?void 0:_.columnNumber)-1]:null,Q.material_description=null!=n&&null!==(b=n.material_description)&&void 0!==b&&b.address&&ee(n,"material_description",a[s],!1,s)?String(a[s][(null==n||null===(x=n.material_description)||void 0===x?void 0:x.columnNumber)-1]):null,Q.material_group=null!=n&&null!==(w=n.material_group)&&void 0!==w&&w.address&&ee(n,"material_group",a[s],"number",s)?a[s][(null==n||null===(A=n.material_group)||void 0===A?void 0:A.columnNumber)-1]:null,Q.material_name=null!=n&&null!==(k=n.material_name)&&void 0!==k&&k.address&&ee(n,"material_name",a[s],!1,s)?String(a[s][(null==n||null===(E=n.material_name)||void 0===E?void 0:E.columnNumber)-1]):null,Q.parent_id=null!=n&&null!==(I=n.parent_id)&&void 0!==I&&I.address&&ee(n,"parent_id",a[s],"number",s)?a[s][(null==n||null===(S=n.parent_id)||void 0===S?void 0:S.columnNumber)-1]:null,Q.plm_material_id=null!=n&&null!==(C=n.plm_material_id)&&void 0!==C&&C.address&&ee(n,"plm_material_id",a[s],!1,s)?String(a[s][(null==n||null===(B=n.plm_material_id)||void 0===B?void 0:B.columnNumber)-1]):null,Q.plm_record_id=null!=n&&null!==(j=n.plm_record_id)&&void 0!==j&&j.address&&ee(n,"plm_record_id",a[s],!1,s)?String(a[s][(null==n||null===(N=n.plm_record_id)||void 0===N?void 0:N.columnNumber)-1]):null,Q.product_code=null!=n&&null!==($=n.product_code)&&void 0!==$&&$.address&&ee(n,"product_code",a[s],"number",s)?a[s][(null==n||null===(O=n.product_code)||void 0===O?void 0:O.columnNumber)-1]:null,Q.quantity=null!=n&&null!==(L=n.quantity)&&void 0!==L&&L.address&&ee(n,"quantity",a[s],"number",s)?a[s][(null==n||null===(P=n.quantity)||void 0===P?void 0:P.columnNumber)-1]:null,Q.storage_loc=null!=n&&null!==(F=n.storage_loc)&&void 0!==F&&F.address&&ee(n,"storage_loc",a[s],"number",s)?a[s][(null==n||null===(U=n.storage_loc)||void 0===U?void 0:U.columnNumber)-1]:null,Q.unit_cost=null!=n&&null!==(M=n.unit_cost)&&void 0!==M&&M.address&&ee(n,"unit_cost",a[s],"number",s)?a[s][(null==n||null===(G=n.unit_cost)||void 0===G?void 0:G.columnNumber)-1]:null,Q.unit_of_material=null!=n&&null!==(q=n.unit_of_material)&&void 0!==q&&q.address&&ee(n,"unit_of_material",a[s],!1,s)?String(a[s][(null==n||null===(D=n.unit_of_material)||void 0===D?void 0:D.columnNumber)-1]):null,Q.unit_sale_price=null!=n&&null!==(Z=n.unit_sale_price)&&void 0!==Z&&Z.address&&ee(n,"unit_sale_price",a[s],"number",s)?a[s][(null==n||null===(Y=n.unit_sale_price)||void 0===Y?void 0:Y.columnNumber)-1]:null,Q.weight_unit=null!=n&&null!==(H=n.weight_unit)&&void 0!==H&&H.address&&ee(n,"weight_unit",a[s],!1,s)?String(a[s][(null==n||null===(V=n.weight_unit)||void 0===V?void 0:V.columnNumber)-1]):null,i.push(Q),K=null!=n&&null!==(X=n.tags)&&void 0!==X&&X.address&&ee(n,"tags",a[s],!1,s)?String(a[s][(null==n||null===(J=n.tags)||void 0===J?void 0:J.columnNumber)-1]):null,Q.custom_material_id&&K&&(u[Q.custom_material_id.trim()]={uploadedId:null,tags:K});if(console.log("materialDataArray",i),!((null==l?void 0:l.length)>0)){e.next=24;break}T(l),document.getElementById("material-export-warning").style.display="block",te=0;case 16:if(!(te<l.length)){e.next=22;break}return e.next=19,ae(l[te]);case 19:te++,e.next=16;break;case 22:e.next=26;break;case 24:R(i),ie(i,u);case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.error(e)}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=H(W().mark((function e(t){return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=H(W().mark((function e(n){return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.workbook.worksheets.getItem(null==h?void 0:h.value).getRange(t).format.fill.color="red",e.next=3,n.sync();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(e,t){u((0,b.Et)(!0));var n=localStorage.getItem("tenantToken"),r={operationName:"exportMaterialMasterDataAsOne",variables:{materials:e},query:E.j_};(0,k.g)(w.Bk,n,r).then(function(){var e=H(W().mark((function e(n){var r,o,i,l,s,c,d,p,f;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n||!n.errors){e.next=5;break}u((0,b.Et)(!1)),n.errors.map((function(e){null!=e&&e.message.includes(C.Ow)?((0,B.kS)(),u((0,a.bs)("homeLogin"))):(0,B.UW)("material-export-failed","Material data  export failed")})),e.next=16;break;case 5:if(null==n||null===(r=n.data)||void 0===r||null===(o=r.insert_core_material_master)||void 0===o||!o.affected_rows){e.next=16;break}d=Z(null==n||null===(s=n.data)||void 0===s||null===(c=s.insert_core_material_master)||void 0===c?void 0:c.returning);try{for(d.s();!(p=d.n()).done;)f=p.value,t[f.custom_material_id.trim()].uploadedId=f.id,q.insert(f.id,t[f.custom_material_id.trim()].tags)}catch(e){d.e(e)}finally{d.f()}return e.next=10,q.uploadAllTags();case 10:return e.next=12,q.uploadMaterialTags();case 12:u((0,b.Et)(!1)),document.getElementById("material-export-success").style.display="block",document.getElementById("material-export-success").innerHTML=(null==n||null===(i=n.data)||void 0===i||null===(l=i.insert_core_material_master)||void 0===l?void 0:l.affected_rows)+" rows successfully exported",(0,x.setTimeout)((function(){document.getElementById("material-export-success").style.display="none"}),3e3);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e,"response after query failed"),u((0,b.Et)(!1))}))};return r.createElement(r.Fragment,null,r.createElement("div",{className:"mm-export-container"},r.createElement("div",null,r.createElement(S.Z,{options:f,styles:D,handleChange:Y,value:h,label:"Selelct the sheet name"})),n?(null==_?void 0:_.length)>0&&r.createElement("table",{className:"mm-export-table"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",null,"Excel Column Name "),r.createElement("th",null,"DTX Column Name "),r.createElement("th",null,"Address"))),r.createElement("tbody",null,null==_?void 0:_.map((function(e){return r.createElement("tr",{key:null==e?void 0:e.dtxField},r.createElement("td",null," ",null==e?void 0:e.excelField),r.createElement("td",null,e.dtxField),r.createElement("td",null,e.address))})))):r.createElement("p",null,"you dont have any mapping configuration data. Please map before exporting"),c&&r.createElement("p",{className:"warning-mustHaveFields"},"check the mapping configuration data, should contain all starred fields"," "),(null==_?void 0:_.length)>0&&!$&&r.createElement("div",{className:"upload"},r.createElement("span",{onClick:function(){V()}},r.createElement(I.Z,{label:"Export 1-by-1"})),r.createElement("span",{onClick:oe},r.createElement(I.Z,{label:"Export All "}))),$&&r.createElement("div",{className:"upload after-export"},r.createElement("div",null,r.createElement("p",null,r.createElement("span",{className:"successNo"},null==l?void 0:l.length)," Row(s) exported successfully"),r.createElement("p",null,r.createElement("span",{className:"failedNo"},null==i?void 0:i.length)," Row(s) failed to export")),r.createElement("div",{className:"after-export-buttons"},r.createElement("button",{className:"cancel",onClick:function(){O(!1)}},"close"),0!==i.length&&r.createElement("button",{className:"reUpload",onClick:re})))),r.createElement("p",{className:"material-export-failed",id:"material-export-failed"}),r.createElement("p",{className:"material-export-success",id:"material-export-success"}),r.createElement("ul",{className:"material-export-warning",id:"material-export-warning"},r.createElement("li",null,"check red shaded area in excel for "),r.createElement("li",null,"Empty values are not allowed "),r.createElement("li",null,"Instead of numbers Strings not allowed and vise versa "),r.createElement("li",null,"check for unwanted data in the sheet ")))}},20890:function(e,t,n){var r=n(87537),o=n.n(r),a=n(23645),i=n.n(a)()(o());i.push([e.id,".react-select-dd p{\r\n    margin:10px 0px 5px 0px\r\n}","",{version:3,sources:["webpack://./src/taskpane/commonComponents/DropDown/DropDown.css"],names:[],mappings:"AAAA;IACI;AACJ",sourcesContent:[".react-select-dd p{\r\n    margin:10px 0px 5px 0px\r\n}"],sourceRoot:""}]),t.Z=i},88638:function(e,t,n){var r=n(87537),o=n.n(r),a=n(23645),i=n.n(a)()(o());i.push([e.id,".mm-export-container{\r\n    padding: 5px;\r\n    display: flex;\r\n   align-items: center;\r\n    flex-direction: column;\r\n}\r\n.mm-export-container table{\r\n    width: 90%;\r\n    border-collapse: collapse;\r\n    margin-top: 15px;\r\n}\r\n.mm-export-table th, td{\r\n    border:1px solid black;\r\n    text-align: center;\r\n    font-size: 12px;\r\n}\r\n.warning-mustHaveFields{\r\n    color:red;\r\n    text-align: center;\r\n    \r\n}\r\n.mm-export-container .upload{\r\nwidth: -webkit-fill-available;\r\nmargin-top: 10px;\r\n    display: flex;\r\n    justify-content: center;\r\ngap:2rem\r\n}\r\n.after-export{\r\n    display: flex;\r\n    align-items: center;\r\n    flex-direction: column;\r\n    width: 100%;\r\n}\r\n.after-export p{\r\n    font-size: 13px;\r\n    margin: 0;\r\n    padding: 0;\r\n    margin-left: 10px;\r\n}\r\n.after-export .cancel{\r\n   border: 1px solid ;\r\n   fill-opacity: 3;\r\n   background-color:white;\r\n   width: 43px;\r\n   padding: 0;\r\n}\r\n.after-export-buttons{\r\n    width: 100%;\r\n    display:flex;\r\n    justify-content: space-evenly;\r\n    margin-top: 10px;\r\n}\r\n.after-export .failedNo{\r\n    color: red;\r\n    font-size:15px;\r\n}\r\n.after-export .successNo{\r\n    font-size:15px;\r\n}\r\n.material-export-warning{\r\n    color: red;\r\n    font-size: x-small;\r\n    margin-bottom: 20px;\r\n    display: none;\r\n    \r\n}\r\n.material-export-warning li:first-child{\r\n    list-style-type: none;\r\n}\r\n.material-export-failed{\r\n    color: red;\r\n    text-align: center;\r\n    display: none;\r\n}\r\n\r\n.material-export-success{\r\n    color:green;\r\n    text-align: center;\r\n    /* display: none; */\r\n}","",{version:3,sources:["webpack://./src/taskpane/commonComponents/Material/MaterialExport/MaterialExport.css"],names:[],mappings:"AAAA;IACI,YAAY;IACZ,aAAa;GACd,mBAAmB;IAClB,sBAAsB;AAC1B;AACA;IACI,UAAU;IACV,yBAAyB;IACzB,gBAAgB;AACpB;AACA;IACI,sBAAsB;IACtB,kBAAkB;IAClB,eAAe;AACnB;AACA;IACI,SAAS;IACT,kBAAkB;;AAEtB;AACA;AACA,6BAA6B;AAC7B,gBAAgB;IACZ,aAAa;IACb,uBAAuB;AAC3B;AACA;AACA;IACI,aAAa;IACb,mBAAmB;IACnB,sBAAsB;IACtB,WAAW;AACf;AACA;IACI,eAAe;IACf,SAAS;IACT,UAAU;IACV,iBAAiB;AACrB;AACA;GACG,kBAAkB;GAClB,eAAe;GACf,sBAAsB;GACtB,WAAW;GACX,UAAU;AACb;AACA;IACI,WAAW;IACX,YAAY;IACZ,6BAA6B;IAC7B,gBAAgB;AACpB;AACA;IACI,UAAU;IACV,cAAc;AAClB;AACA;IACI,cAAc;AAClB;AACA;IACI,UAAU;IACV,kBAAkB;IAClB,mBAAmB;IACnB,aAAa;;AAEjB;AACA;IACI,qBAAqB;AACzB;AACA;IACI,UAAU;IACV,kBAAkB;IAClB,aAAa;AACjB;;AAEA;IACI,WAAW;IACX,kBAAkB;IAClB,mBAAmB;AACvB",sourcesContent:[".mm-export-container{\r\n    padding: 5px;\r\n    display: flex;\r\n   align-items: center;\r\n    flex-direction: column;\r\n}\r\n.mm-export-container table{\r\n    width: 90%;\r\n    border-collapse: collapse;\r\n    margin-top: 15px;\r\n}\r\n.mm-export-table th, td{\r\n    border:1px solid black;\r\n    text-align: center;\r\n    font-size: 12px;\r\n}\r\n.warning-mustHaveFields{\r\n    color:red;\r\n    text-align: center;\r\n    \r\n}\r\n.mm-export-container .upload{\r\nwidth: -webkit-fill-available;\r\nmargin-top: 10px;\r\n    display: flex;\r\n    justify-content: center;\r\ngap:2rem\r\n}\r\n.after-export{\r\n    display: flex;\r\n    align-items: center;\r\n    flex-direction: column;\r\n    width: 100%;\r\n}\r\n.after-export p{\r\n    font-size: 13px;\r\n    margin: 0;\r\n    padding: 0;\r\n    margin-left: 10px;\r\n}\r\n.after-export .cancel{\r\n   border: 1px solid ;\r\n   fill-opacity: 3;\r\n   background-color:white;\r\n   width: 43px;\r\n   padding: 0;\r\n}\r\n.after-export-buttons{\r\n    width: 100%;\r\n    display:flex;\r\n    justify-content: space-evenly;\r\n    margin-top: 10px;\r\n}\r\n.after-export .failedNo{\r\n    color: red;\r\n    font-size:15px;\r\n}\r\n.after-export .successNo{\r\n    font-size:15px;\r\n}\r\n.material-export-warning{\r\n    color: red;\r\n    font-size: x-small;\r\n    margin-bottom: 20px;\r\n    display: none;\r\n    \r\n}\r\n.material-export-warning li:first-child{\r\n    list-style-type: none;\r\n}\r\n.material-export-failed{\r\n    color: red;\r\n    text-align: center;\r\n    display: none;\r\n}\r\n\r\n.material-export-success{\r\n    color:green;\r\n    text-align: center;\r\n    /* display: none; */\r\n}"],sourceRoot:""}]),t.Z=i}}]);
//# sourceMappingURL=27.js.map
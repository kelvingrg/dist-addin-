"use strict";(self.webpackChunkoffice_addin_taskpane_react_js=self.webpackChunkoffice_addin_taskpane_react_js||[]).push([[455],{3193:function(n,e,r){r.d(e,{Bk:function(){return t},ND:function(){return a},_n:function(){return i}});var t="https://beacon-dev.hasura.app/v1/graphql",a="https://kelvingrg.github.io/dist-addin-",i="https://kelvingrg.github.io/dist-addin-"},15677:function(n,e,r){r.d(e,{Ai:function(){return l},BO:function(){return f},FT:function(){return c},J6:function(){return a},Ok:function(){return s},V4:function(){return _},Y9:function(){return d},ZL:function(){return t},gh:function(){return g},kN:function(){return i},o_:function(){return m},rE:function(){return h},vZ:function(){return o},xq:function(){return A},z0:function(){return p},zG:function(){return u}});var t="query GetAllBomListByProductCodeQuery($product_code: Int!) {\n    core_bom(where: {product_code: {_eq: $product_code}}) {\n      id\n      name\n    }\n}\n",a="query allBomAssociatedwithATenant {\n  core_bom {\n    id\n    name\n  }\n}",i="query GetBomdetailsByBomId($bom_id: Int!, $active: Boolean!) {\n  bom_items(\n    where: {bom_id: {_eq: $bom_id}, bom_version: {active: {_eq: $active}}}\n  ) {\n    bom_id\n    bom_version_id\n    material_id\n    quantity\n    total_price\n    unit_size\n    associated_product_code_bom\n    associated_bom_version {\n      version_no\n      id\n      active\n      core_bom {\n        id\n        name\n      }\n    }\n    core_material {\n      custom_material_id\n      erp_material_id\n      gross_weight\n      id\n      inventory\n      lead_time\n      material_description\n      material_group\n      material_name\n      material_type\n      parent_id\n      plm_material_id\n      plm_record_id\n      product_code\n      quantity\n      status\n      storage_loc\n      unit_cost\n      unit_of_material\n      unit_sale_price\n      weight_unit\n      material_product_code {\n        id\n        product_code\n      }\n    }\n    core_bom {\n      state         \n      tenant_id\n    }\n  }\n}\n  ",o="query GetMaterialMasterDataQuery(\n    $jump: Int,\n    $perPage: Int,\n    $searchKeyword: String\n    ) {\n    core_material_master_aggregate(where: {_or: [\n      {custom_material_id: {_ilike: $searchKeyword}},\n      {erp_material_id: {_ilike: $searchKeyword}},\n      {material_description: {_ilike: $searchKeyword}},\n      {material_name: {_ilike: $searchKeyword}},\n      {material_type: {_ilike: $searchKeyword}},\n      {plm_material_id: {_ilike: $searchKeyword}},\n      {unit_of_material: {_ilike: $searchKeyword}},\n      {material_product_code: {\n        product_code: {_ilike: $searchKeyword}}\n      }\n    ]}){\n      aggregate {\n        count\n      }\n    }\n    core_material_master(\n      where: {_or: [\n        {custom_material_id: {_ilike: $searchKeyword}},\n        {erp_material_id: {_ilike: $searchKeyword}},\n        {material_description: {_ilike: $searchKeyword}},\n        {material_name: {_ilike: $searchKeyword}},\n        {material_type: {_ilike: $searchKeyword}},\n        {plm_material_id: {_ilike: $searchKeyword}},\n        {unit_of_material: {_ilike: $searchKeyword}},\n        {material_product_code: {\n          product_code: {_ilike: $searchKeyword}}\n        }\n      ]}\n      limit: $perPage\n      offset: $jump\n    ) {\n      custom_material_id\n      erp_material_id\n      blob_reference_key\n      id\n      gross_weight\n      inventory\n      lead_time\n      material_description\n      material_group\n      material_name\n      material_type\n      others\n      parent_id\n      plm_material_id\n      plm_record_id\n      quantity\n      status\n      storage_loc\n      unit_cost\n      unit_of_material\n      unit_sale_price\n      weight_unit\n      product_code\n      material_product_code {\n        id\n        product_code\n      }\n    }\n  }\n  ",l="query GetAllProductCodes {\n  product_code {\n    id\n    product_code\n  }\n}\n",c="query GetAllBomListByProductCodeActive($product_code: Int!) {\n  core_bom(where: {product_code: {_eq: $product_code}}) {\n    id\n    name\n    bom_versions(where: {active: {_eq: true}}) {\n      id\n      version_no\n      active\n    }\n  }\n}\n",d="query GetAllBomItemsByBomVersionIdQuery($bom_version: Int) {\n  bom_items(where: {bom_version_id: {_eq: $bom_version}}) {\n    associated_product_code_bom\n    associated_bom_version {\n      version_no\n      id\n      active\n      core_bom {\n        id\n        name\n      }\n    }\n    material_id\n    quantity\n    total_price\n    unit_size\n    core_material {\n      custom_material_id\n        erp_material_id\n        blob_reference_key\n        id\n        gross_weight\n        inventory\n        lead_time\n        material_description\n        material_group\n        material_name\n        material_type\n        others\n        parent_id\n        plm_material_id\n        plm_record_id\n        quantity\n        status\n        storage_loc\n        unit_cost\n        unit_of_material\n        unit_sale_price\n        weight_unit\n        product_code\n        material_product_code {\n          id\n          product_code\n        }\n       \n    }\n    core_bom {\n      name\n      id\n    }\n  }\n}",s="query GetAllProjectBomListQuery($projectId: Int!)  {\n  core_bom(where: {project_id: {_eq: $projectId}}) {\n    id\n    name\n    bom_versions(where: {active: {_eq: true}}) {\n      id\n      version_no\n      active\n    }\n    project_id\n  }\n}",_="query getParentTags($value: String!) {\n  tag(where: {name: {_iregex: $value}, parent_id: {_is_null: true}}) {\n    parent_id\n    name\n    id\n  }\n}",m="query getChildrenTagsQuery($value:String!,$parent_id:Int){\n  tag(where: {name: {_iregex: $value}, parent_id: {_eq: $parent_id}}) {\n     parent_id\n     name\n     id\n   }\n }",u="query GetMaterialMasterForBomQueryWithTagFilters(\n  $jump: Int,\n  $perPage: Int,\n  $searchKeyword: String,\n  $materialIds:[Int!]\n  ) {\n  core_material_master_aggregate(where:{_and:[\n    {_or: [\n    {custom_material_id: {_ilike: $searchKeyword}},\n    {erp_material_id: {_ilike: $searchKeyword}},\n    {material_description: {_ilike: $searchKeyword}},\n    {material_name: {_ilike: $searchKeyword}},\n    {material_type: {_ilike: $searchKeyword}},\n    {plm_material_id: {_ilike: $searchKeyword}},\n    {unit_of_material: {_ilike: $searchKeyword}},\n    {material_product_code: {\n      product_code: {_ilike: $searchKeyword}}\n    }]},\n    {id: {\n      _in: $materialIds\n    }}\n  ]}){\n    aggregate {\n      count\n    }\n  }\n  core_material_master(\n    where:{_and:[\n    {_or: [\n    {custom_material_id: {_ilike: $searchKeyword}},\n    {erp_material_id: {_ilike: $searchKeyword}},\n    {material_description: {_ilike: $searchKeyword}},\n    {material_name: {_ilike: $searchKeyword}},\n    {material_type: {_ilike: $searchKeyword}},\n    {plm_material_id: {_ilike: $searchKeyword}},\n    {unit_of_material: {_ilike: $searchKeyword}},\n    {material_product_code: {\n      product_code: {_ilike: $searchKeyword}}\n    }]},\n    {id: {\n      _in: $materialIds\n    }}\n  ]}\n    limit: $perPage\n    offset: $jump\n  ) {\n    custom_material_id\n    erp_material_id\n    id\n    lead_time\n    material_description\n    material_name\n    material_type\n    plm_material_id\n    unit_of_material\n    product_code\n    material_product_code {\n      id\n      product_code\n    }\n  }\n}\n",p="query getMaterialTags(\n  $tags:[Int!]!\n){\n  tag_material(where: {tag_id: {_in: $tags}}) {\n    material_id\n  }\n}\n",A="query GetDetailFormTemplateQuery($id: Int!) {\n  core_form_templates_by_pk(id: $id) {\n    name\n    id\n    core_form_type {\n      name\n    }\n    template_versions(where: {active: {_eq: true}}) {\n      active\n      version_id\n      id\n      template_fields {\n        autogenerated\n        caption\n        custom_list_id\n        field_id\n        field_name\n        field_type_id\n        fixed\n        required\n        template_version_id\n        form_field {\n          key\n        }\n      }\n    }\n  }\n}",g="query GetAllFormTemplatesQuery{\n  core_form_templates {\n    name\n    id\n    core_form_type {\n      name\n    }\n    template_versions(where: {active: {_eq: true}}) {\n      active\n      version_id\n    }\n  }\n}",h="query GetBomMaterialMappingConfigQuery($tenant_id: Int!) {\n  tenant_defaults(where: {tenant_id: {_eq: $tenant_id}}) {\n    bom\n    material\n  }\n}",f="query GetBomCurrentStateQuery($bom_id: Int!) {\n  core_bom(where: {id: {_eq: $bom_id}}) {\n    state\n    name\n    checked_out_by\n  }\n}"},57276:function(n,e,r){r.d(e,{Z:function(){return b}});var t=r(67294),a=r(85656),i=r(21559),o=r(93379),l=r.n(o),c=r(7795),d=r.n(c),s=r(90569),_=r.n(s),m=r(3565),u=r.n(m),p=r(19216),A=r.n(p),g=r(44589),h=r.n(g),f=r(51621),v={};v.styleTagTransform=h(),v.setAttributes=u(),v.insert=_().bind(null,"head"),v.domAPI=d(),v.insertStyleElement=A(),l()(f.Z,v),f.Z&&f.Z.locals&&f.Z.locals;var y=r(3193),b=function(){var n=(0,a.v9)((function(n){return null==n?void 0:n.taskpane})).nextPage,e=(0,a.I0)(),r=(0,a.v9)((function(n){return null==n?void 0:n.action})).materialAction;return t.createElement("div",{className:"navbar"},t.createElement("div",{className:"navbar-logo"},t.createElement("img",{src:"".concat(y._n,"/assets/beacon-without-background -logo.png ")})),"material"===n&&t.createElement("div",{className:"navbar-option"},t.createElement("span",{className:"navbar-button ".concat("get"==r?"selectedAction":null),onClick:function(){return e((0,i.XZ)("get"))}},"Get"),t.createElement("span",{className:"navbar-button ".concat("map"==r?"selectedAction":null),onClick:function(){return e((0,i.XZ)("map"))}},"Map"),t.createElement("span",{className:"navbar-button ".concat("export"==r?"selectedAction":null),onClick:function(){return e((0,i.XZ)("export"))}},"Export"),t.createElement("span",{className:"navbar-button ".concat("update"==r?"selectedAction":null),onClick:function(){return e((0,i.XZ)("update"))}},"Update")))}},78455:function(n,e,r){r.r(e),r.d(e,{default:function(){return j}});var t=r(67294),a=r(93379),i=r.n(a),o=r(7795),l=r.n(o),c=r(90569),d=r.n(c),s=r(3565),_=r.n(s),m=r(19216),u=r.n(m),p=r(44589),A=r.n(p),g=r(38932),h={};h.styleTagTransform=A(),h.setAttributes=_(),h.insert=d().bind(null,"head"),h.domAPI=l(),h.insertStyleElement=u(),i()(g.Z,h),g.Z&&g.Z.locals&&g.Z.locals;var f=r(3193);r(57276);var v=function(){return t.createElement("header",{className:"ms-welcome__header"},t.createElement("img",{src:"".concat(f._n,"/assets/beacon-without-background -logo.png"),alt:"Beacon-India",title:"Beacon-India"}),t.createElement("p",null,"Beacon-DTX Excel plugin"))},y=r(2339),b={};b.styleTagTransform=A(),b.setAttributes=_(),b.insert=d().bind(null,"head"),b.domAPI=l(),b.insertStyleElement=u(),i()(y.Z,b),y.Z&&y.Z.locals&&y.Z.locals;var I=r(46027),w=r(85656),C=r(5274),B=r(5449),k=r(68518),x=r(21559),$=r(88725),E=r(12961),q=r(15677),K=r(19018),Z=r(60392),j=function(){var n=(0,w.I0)(),e=(0,w.v9)((function(n){return n.action})).uploadLoader;return t.createElement(t.Fragment,null,t.createElement("div",{className:"HomeLoginBody ",id:"commonContainer"},t.createElement(v,null),t.createElement("main",{id:"app-body",className:"loginHome"},t.createElement("span",{onClick:function(){B.g.dialog;try{Office.context.ui.displayDialogAsync("".concat(f._n,"/login.html"),{height:62,width:45,displayInIframe:!0},(function(n){B.g.dialog=n.value,B.g.dialog.addEventHandler(Office.EventType.DialogMessageReceived,e)}));var e=function(e){localStorage.setItem("beaconToken",e.message),n((0,x.Et)(!0)),B.g.dialog.close(),function(){try{var e=localStorage.getItem("beaconToken"),r=function(n){try{var e=n.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(window.atob(e).split("").map((function(n){return"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(r)}catch(n){console.log(n)}}(e);localStorage.setItem("tenantId",r["x-hasura-tenant-id"]),localStorage.setItem("expiry",r.exp),n((0,I.kw)(r["x-hasura-user-id"]));var t={"Content-Type":"application/json",Authorization:"Bearer "+e};C.Z.post("".concat(f.ND,"/user/tokenExchange"),{tenantId:r["x-hasura-tenant-id"]},{headers:t}).then((function(e){var r,t;localStorage.setItem("tenantToken",null==e||null===(r=e.data)||void 0===r?void 0:r.message),localStorage.setItem("projectExchangeToken",null==e||null===(t=e.data)||void 0===t?void 0:t.message),function(){try{var e={operationName:"GetBomMaterialMappingConfigQuery",query:q.rE,variables:{tenant_id:localStorage.getItem("tenantId")}};(0,E.V)(f.Bk,localStorage.getItem("tenantToken"),e).then((function(e){var r,t,a,i;e.errors?e.errors.map((function(e){null!=e&&e.message.includes(Z.Ow)&&((0,K.kS)(),n((0,I.bs)("homeLogin")))})):(n((0,I.lc)(null==e||null===(r=e.data)||void 0===r?void 0:r.tenant_defaults[0].material)),n((0,I.JH)(null==e||null===(t=e.data)||void 0===t?void 0:t.tenant_defaults[0].bom)),n((0,x.hT)(null==e||null===(a=e.data)||void 0===a?void 0:a.tenant_defaults[0].material)),n((0,x.Es)(null==e||null===(i=e.data)||void 0===i?void 0:i.tenant_defaults[0].bom)))})).catch((function(n){console.log(n.message,"error.message")}))}catch(n){console.log(n)}}(),n((0,x.Et)(!1))})).catch((function(e){console.log(e),n((0,x.Et)(!1))}))}catch(n){console.log("Error:",n)}finally{n((0,x.Et)(!1))}}(),n((0,I.bs)("material"))}}catch(e){console.log(e),n((0,x.Et)(!1))}}},t.createElement(k.Z,{label:"Login"})))),e&&t.createElement($.default,null))}},38932:function(n,e,r){var t=r(87537),a=r.n(t),i=r(23645),o=r.n(i)()(a());o.push([n.id,"img{\r\n    width: 106px;;\r\n  height:30px;\r\n}\r\n.ms-welcome__header {\r\n    padding-top: 20px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    border-bottom: solid 1px;\r\n }","",{version:3,sources:["webpack://./src/taskpane/commonComponents/BeaconHeader/BeaconHeader.css"],names:[],mappings:"AAAA;IACI,YAAY;EACd,WAAW;AACb;AACA;IACI,iBAAiB;IACjB,aAAa;IACb,sBAAsB;IACtB,mBAAmB;IACnB,wBAAwB;CAC3B",sourcesContent:["img{\r\n    width: 106px;;\r\n  height:30px;\r\n}\r\n.ms-welcome__header {\r\n    padding-top: 20px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    border-bottom: solid 1px;\r\n }"],sourceRoot:""}]),e.Z=o},51621:function(n,e,r){var t=r(87537),a=r.n(t),i=r(23645),o=r.n(i)()(a());o.push([n.id,".navbar{\r\n    width: 100%;\r\n    height: 100%;\r\n    flex-grow: 1;\r\n    display: flex;;\r\n    align-items: center;\r\n    justify-content: center ;\r\n}\r\n.navbar span {\r\n    margin: 10 px;\r\n    padding: 5px;\r\n    font-size: x-small;\r\n    cursor: pointer;\r\n}\r\n.navbar-logo{\r\n    height:100%;\r\n    flex-grow: 1; \r\n    display: flex;\r\n    justify-content: flex-start;\r\n    align-items: center;  \r\n}\r\n.navbar-logo img{\r\n    height: 28px;\r\n    width: 98px;\r\n    margin-left: 12px;\r\n}\r\n.navbar-option{\r\n    height:100%;\r\n    flex-grow: 6;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 3px;    \r\n}\r\n.navbar-option span{\r\n\r\npadding: 5px;\r\n}\r\n.navbar-option span:hover{\r\n    border-bottom: 1px #383332 solid;\r\n    background-color:#FFC467; \r\n\r\n}\r\n.navbar-logout{\r\n\r\n    height:100%;\r\n    flex-grow: 1;  \r\n}\r\n\r\n.selectedAction{\r\n    border-bottom: 2px #383332 solid; \r\n}\r\n","",{version:3,sources:["webpack://./src/taskpane/commonComponents/Material/Navbar/NavBar.css"],names:[],mappings:"AAAA;IACI,WAAW;IACX,YAAY;IACZ,YAAY;IACZ,aAAa;IACb,mBAAmB;IACnB,wBAAwB;AAC5B;AACA;IACI,aAAa;IACb,YAAY;IACZ,kBAAkB;IAClB,eAAe;AACnB;AACA;IACI,WAAW;IACX,YAAY;IACZ,aAAa;IACb,2BAA2B;IAC3B,mBAAmB;AACvB;AACA;IACI,YAAY;IACZ,WAAW;IACX,iBAAiB;AACrB;AACA;IACI,WAAW;IACX,YAAY;IACZ,aAAa;IACb,uBAAuB;IACvB,mBAAmB;IACnB,QAAQ;AACZ;AACA;;AAEA,YAAY;AACZ;AACA;IACI,gCAAgC;IAChC,wBAAwB;;AAE5B;AACA;;IAEI,WAAW;IACX,YAAY;AAChB;;AAEA;IACI,gCAAgC;AACpC",sourcesContent:[".navbar{\r\n    width: 100%;\r\n    height: 100%;\r\n    flex-grow: 1;\r\n    display: flex;;\r\n    align-items: center;\r\n    justify-content: center ;\r\n}\r\n.navbar span {\r\n    margin: 10 px;\r\n    padding: 5px;\r\n    font-size: x-small;\r\n    cursor: pointer;\r\n}\r\n.navbar-logo{\r\n    height:100%;\r\n    flex-grow: 1; \r\n    display: flex;\r\n    justify-content: flex-start;\r\n    align-items: center;  \r\n}\r\n.navbar-logo img{\r\n    height: 28px;\r\n    width: 98px;\r\n    margin-left: 12px;\r\n}\r\n.navbar-option{\r\n    height:100%;\r\n    flex-grow: 6;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 3px;    \r\n}\r\n.navbar-option span{\r\n\r\npadding: 5px;\r\n}\r\n.navbar-option span:hover{\r\n    border-bottom: 1px #383332 solid;\r\n    background-color:#FFC467; \r\n\r\n}\r\n.navbar-logout{\r\n\r\n    height:100%;\r\n    flex-grow: 1;  \r\n}\r\n\r\n.selectedAction{\r\n    border-bottom: 2px #383332 solid; \r\n}\r\n"],sourceRoot:""}]),e.Z=o},2339:function(n,e,r){var t=r(87537),a=r.n(t),i=r(23645),o=r.n(i)()(a());o.push([n.id,"\r\n.HomeLoginBody{\r\n    padding: 0;\r\n    margin:0;\r\n    background-color: white;\r\n    height: 100vh;\r\n    width:100vw;\r\n}\r\n\r\n.loginHome span {\r\n    color: #383332;\r\n    border-radius: 3px;\r\n    margin-top: 30px;\r\n}\r\n.loginHome{\r\n\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n}","",{version:3,sources:["webpack://./src/taskpane/pages/HomeLogin/HomeLogin.css"],names:[],mappings:";AACA;IACI,UAAU;IACV,QAAQ;IACR,uBAAuB;IACvB,aAAa;IACb,WAAW;AACf;;AAEA;IACI,cAAc;IACd,kBAAkB;IAClB,gBAAgB;AACpB;AACA;;IAEI,aAAa;IACb,uBAAuB;IACvB,mBAAmB;AACvB",sourcesContent:["\r\n.HomeLoginBody{\r\n    padding: 0;\r\n    margin:0;\r\n    background-color: white;\r\n    height: 100vh;\r\n    width:100vw;\r\n}\r\n\r\n.loginHome span {\r\n    color: #383332;\r\n    border-radius: 3px;\r\n    margin-top: 30px;\r\n}\r\n.loginHome{\r\n\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n}"],sourceRoot:""}]),e.Z=o}}]);
//# sourceMappingURL=455.js.map